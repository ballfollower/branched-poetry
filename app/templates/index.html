{% extends 'base.html' %}

{% block style %}
  <style>
    table {
      width: 100%;
      max-width: 600px;
      margin: 15px;
    }
    
    #poemSoFar {
      background-color: #ffb;
      text-align: center;

      height: 15em;
    }
  </style>
{% endblock %}

{% block script %}
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <script>
    function postVerse(){
      $.post("http://127.0.0.1:5000/ajax/verseProvider", {year: '2017', semester: 1}, function(result){
        console.log(result);
      });
    }
  </script>
{% endblock %}

{% block content %}
  <table>
    <tr>
      <td id="poemSoFar"></td>
      <td>
        <input id="searchInput" 
          type="text" 
          placeholder="Next Verse..." >
        <br>
        {% for firstVerse in verses %}
        <div class="verseToChoose">
          {{ firstVerse.text }}
        </div>
        {% endfor %}    
      </td>
    </tr>
    <tr>
      <td>
        <button disabled>
          Copy to Clipboard
        </button>
        
        <button disabled>
          Start Over
        </button>          
      </td>
      <td><button onclick="postVerse()">[button for debugging]</button></td>
    </tr>
  </table>
  <script>
    $("#searchInput").on('keyup', function(e){
      if (e.key === 'Enter' || e.keyCode === 13) {
        if($("#poemSoFar").length){
          $("#poemSoFar").append("<br>");
        }
        $("#poemSoFar").append($(this).val());
        //alert($(this).val());
      }

      var input = $("#searchInput");
      var filter = input.val().toUpperCase();

      var versesToChoose = $(".verseToChoose");

      for (var i = 0; i < versesToChoose.length; i++) {
        var txtValue = versesToChoose[i].textContent || versesToChoose[i].innerText;

        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          versesToChoose[i].style.display = "";
        } else {
          versesToChoose[i].style.display = "none";
        }
      }
    });
  </script>
{% endblock %}